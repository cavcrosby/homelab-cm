---
- name: Create the Jenkins namespace in the Kubernetes cluster
  kubernetes.core.k8s:
    api_version: v1
    kind: Namespace
    name: "{{ jenkins_instance_name }}"
    state: present
  become: true
  environment:
    KUBECONFIG: /etc/kubernetes/admin.conf

- name: Apply the Jenkins manifest to the Kubernetes cluster
  kubernetes.core.k8s:
    template: "{{ jenkins_manifest_template }}"
    state: present
  become: true
  environment:
    KUBECONFIG: /etc/kubernetes/admin.conf
